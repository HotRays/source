From 5c90d99b96389e9e5a55508f33d8b95a50bb6519 Mon Sep 17 00:00:00 2001
From: fengmushu <fengmushu@gmail.com>
Date: Fri, 1 Jun 2018 16:02:33 +0800
Subject: [PATCH] fixup usb power-en GPIO

---
 arch/arm64/boot/dts/allwinner/sun50i-h6-tempe-lite2.dts | 16 +++++++++++++---
 1 file changed, 13 insertions(+), 3 deletions(-)

diff --git a/arch/arm64/boot/dts/allwinner/sun50i-h6-tempe-lite2.dts b/arch/arm64/boot/dts/allwinner/sun50i-h6-tempe-lite2.dts
index 019d842..b2a06e4 100644
--- a/arch/arm64/boot/dts/allwinner/sun50i-h6-tempe-lite2.dts
+++ b/arch/arm64/boot/dts/allwinner/sun50i-h6-tempe-lite2.dts
@@ -53,6 +53,16 @@
 		reset-gpios = <&r_pio 1 3 GPIO_ACTIVE_LOW>; /* PM3 */
 		post-power-on-delay-ms = <50>;
 	};
+
+	reg_usb_vbus: vbus {
+		compatible = "regulator-fixed";
+		regulator-name = "usb-vbus";
+		regulator-min-microvolt = <5000000>;
+		regulator-max-microvolt = <5000000>;
+		startup-delay-us = <100000>;
+		gpio = <&r_pio 0 5 GPIO_ACTIVE_HIGH>;
+		enable-active-high;
+	};
 };
 
 &cpu0 {
@@ -264,8 +274,8 @@
 };
 
 &usb2phy {
-	usb0_vbus-supply = <&reg_cldo1>;
-	usb3_vbus-supply = <&reg_cldo1>;
+	usb0_vbus-supply = <&reg_usb_vbus>;
+	usb3_vbus-supply = <&reg_usb_vbus>;
 	status = "okay";
 };
 
@@ -274,6 +284,6 @@
 };
 
 &usb3phy {
-	phy-supply = <&reg_cldo1>;
+	phy-supply = <&reg_usb_vbus>;
 	status = "okay";
 };
-- 
2.14.2

